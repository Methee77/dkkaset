import React, { useState, useMemo } from "react";

// Modern Registrar / Assessment UI - Single-file React component (Tailwind CSS required)
// Features: responsive header, stats, announcements, searchable student table, quick actions, upload preview

export default function RegistrarDashboard() {
  const [query, setQuery] = useState("");
  const [selectedYear, setSelectedYear] = useState("2025");
  const [students] = useState([
    { id: "641001", name: "กมล พงศ์", program: "วิทยาศาสตร์การเกษตร", year: "2025", status: "สำเร็จ" },
    { id: "641002", name: "สมชาย ใจดี", program: "บริหารธุรกิจ", year: "2024", status: "กำลังศึกษา" },
    { id: "641003", name: "จินตนา แซ่ลิ้ม", program: "เทคโนโลยีอาหาร", year: "2025", status: "สำเร็จ" },
    { id: "641004", name: "มานพ สายทอง", program: "วิศวกรรม", year: "2023", status: "ลาออก" },
    // เพิ่มข้อมูลตัวอย่างตามต้องการ
  ]);

  const stats = useMemo(() => ({
    totalStudents: students.length,
    graduates: students.filter(s => s.status === "สำเร็จ").length,
    active: students.filter(s => s.status === "กำลังศึกษา").length,
    pendingDocs: 12,
  }), [students]);

  const filtered = useMemo(() => students.filter(s => {
    const q = query.trim().toLowerCase();
    if (selectedYear && s.year !== selectedYear) return false;
    if (!q) return true;
    return s.name.toLowerCase().includes(q) || s.id.includes(q) || s.program.toLowerCase().includes(q);
  }), [students, query, selectedYear]);

  // small helper UI components
  const StatCard = ({ title, value, hint }) => (
    <div className="bg-white/80 backdrop-blur rounded-3xl p-4 shadow-xl hover:shadow-2xl transition-shadow duration-300-sm border border-gray-100">
      <div className="text-sm text-gray-500">{title}</div>
      <div className="mt-2 text-2xl font-semibold">{value}</div>
      {hint && <div className="text-xs text-gray-400 mt-1">{hint}</div>}
    </div>
  );

  return (
    <div className="min-h-screen bg-gradient-to-br from-indigo-50 via-sky-100 to-white dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 transition-all duration-500 p-6">
      <header className="max-w-7xl mx-auto flex items-center justify-between mb-6">
        <div className="flex items-center gap-4">
          <div className="w-12 h-12 animate-pulse rounded-lg bg-gradient-to-br from-indigo-600 to-sky-500 flex items-center justify-center text-white font-bold">ทร</div>
          <div>
            <div className="text-lg font-bold">งานทะเบียนวัดผล</div>
            <div className="text-sm text-gray-500">ระบบจัดการข้อมูลนิสิต - รายงาน - ประกาศ</div>
          </div>
        </div>
        <div className="flex items-center gap-3">
          <button className="px-4 py-2 bg-white rounded-lg shadow-xl hover:shadow-2xl transition-shadow duration-300-sm border">คำสั่งด่วน</button>
          <div className="flex items-center gap-3 bg-white rounded-full px-3 py-1 shadow-xl hover:shadow-2xl transition-shadow duration-300-sm">
            <img src="https://via.placeholder.com/36" alt="avatar" className="w-8 h-8 rounded-full" />
            <div className="text-sm">
              <div className="font-medium">เจ้าหน้าที่ ทร.</div>
              <div className="text-xs text-gray-400">admin@univ.ac.th</div>
            </div>
          </div>
        </div>
      </header>

      <main className="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-4 gap-6">
        {/* Left column: main dashboard */}
        <section className="lg:col-span-3 space-y-6">
          <div className="bg-gradient-to-r from-white to-sky-50 rounded-3xl p-6 shadow-xl hover:shadow-2xl transition-shadow duration-300">
            <div className="flex items-center justify-between">
              <div>
                <h1 className="text-2xl font-bold">แดชบอร์ด</h1>
                <p className="text-sm text-gray-500">ภาพรวมสถานะการทะเบียนและการวัดผลของนิสิต</p>
              </div>
              <div className="flex items-center gap-3">
                <select value={selectedYear} onChange={(e) => setSelectedYear(e.target.value)} className="rounded-lg border px-3 py-2 bg-white">
                  <option value="">ทุกปีการศึกษา</option>
                  <option value="2025">ปีการศึกษา 2025</option>
                  <option value="2024">ปีการศึกษา 2024</option>
                  <option value="2023">ปีการศึกษา 2023</option>
                </select>
                <button className="px-4 py-2 rounded-lg bg-indigo-600 text-white">ส่งออก CSV</button>
              </div>
            </div>

            <div className="mt-6 grid grid-cols-2 sm:grid-cols-4 gap-4">
              <StatCard title="นิสิตทั้งหมด" value={stats.totalStudents} hint="รวมทุกหลักสูตร" />
              <StatCard title="สำเร็จการศึกษา" value={stats.graduates} hint="อนุมัติประกาศนียบัตร" />
              <StatCard title="กำลังศึกษา" value={stats.active} hint="ไม่รวมระงับการเรียน" />
              <StatCard title="เอกสารค้างตรวจ" value={stats.pendingDocs} hint="เอกสารรอตรวจสอบ" />
            </div>
          </div>

          <div className="bg-white rounded-3xl p-6 shadow-xl hover:shadow-2xl transition-shadow duration-300">
            <div className="flex items-center justify-between">
              <h2 className="text-lg font-semibold">ประกาศล่าสุด</h2>
              <button className="text-sm text-indigo-600">ดูทั้งหมด</button>
            </div>

            <ul className="mt-4 space-y-3">
              <li className="p-3 rounded-lg border hover:bg-indigo-50 transition">
                <div className="flex items-center justify-between">
                  <div>
                    <div className="font-medium">ปิดปรับปรุงระบบวันที่ 15 ธ.ค. 2025</div>
                    <div className="text-sm text-gray-500 mt-1">เพื่ออัพเดตฐานข้อมูลและปรับปรุงระบบรายงาน</div>
                  </div>
                  <div className="text-xs text-gray-400">3 ชั่วโมงที่ผ่านมา</div>
                </div>
              </li>

              <li className="p-3 rounded-lg border hover:bg-indigo-50 transition">
                <div className="flex items-center justify-between">
                  <div>
                    <div className="font-medium">กำหนดส่งเกรดภายใน 20 ธ.ค. 2025</div>
                    <div className="text-sm text-gray-500 mt-1">กรุณาส่งรายการผ่านระบบก่อนเวลา</div>
                  </div>
                  <div className="text-xs text-gray-400">1 วันก่อน</div>
                </div>
              </li>
            </ul>
          </div>

          <div className="bg-white rounded-3xl p-6 shadow-xl hover:shadow-2xl transition-shadow duration-300">
            <div className="flex items-center justify-between">
              <h2 className="text-lg font-semibold">ค้นหานิสิต</h2>
              <div className="text-sm text-gray-400">ผลลัพธ์ {filtered.length} รายการ</div>
            </div>

            <div className="mt-4 flex gap-3 flex-col sm:flex-row">
              <input value={query} onChange={(e) => setQuery(e.target.value)} placeholder="ค้นหาชื่อ, รหัสนิสิต, สาขา..." className="flex-1 rounded-lg border px-4 py-2" />
              <button className="px-4 py-2 rounded-lg bg-green-500 text-white">เพิ่มนิสิต</button>
              <button className="px-4 py-2 rounded-lg bg-yellow-400 text-white">นำเข้า</button>
            </div>

            <div className="mt-4 overflow-x-auto">
              <table className="w-full table-auto">
                <thead className="text-sm text-left text-gray-500">
                  <tr>
                    <th className="px-3 py-2">รหัส</th>
                    <th className="px-3 py-2">ชื่อ</th>
                    <th className="px-3 py-2">สาขา</th>
                    <th className="px-3 py-2">ปี</th>
                    <th className="px-3 py-2">สถานะ</th>
                    <th className="px-3 py-2">จัดการ</th>
                  </tr>
                </thead>
                <tbody>
                  {filtered.map(s => (
                    <tr key={s.id} className="border-t">
                      <td className="px-3 py-3">{s.id}</td>
                      <td className="px-3 py-3 font-medium">{s.name}</td>
                      <td className="px-3 py-3">{s.program}</td>
                      <td className="px-3 py-3">{s.year}</td>
                      <td className="px-3 py-3">{s.status}</td>
                      <td className="px-3 py-3">
                        <div className="flex gap-2">
                          <button className="px-3 py-1 rounded bg-blue-600 text-white text-sm">ดู</button>
                          <button className="px-3 py-1 rounded bg-gray-200 text-sm">แก้ไข</button>
                        </div>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </div>
        </section>

        {/* Right column: quick actions / uploads / contacts */}
        <aside className="space-y-6">
          <div className="bg-white rounded-3xl p-4 shadow-xl hover:shadow-2xl transition-shadow duration-300 sticky top-6">
            <h3 className="font-semibold">คำสั่งด่วน</h3>
            <div className="mt-3 grid gap-3">
              <button className="w-full py-2 rounded-lg bg-indigo-600 text-white">ออกเอกสารรับรอง</button>
              <button className="w-full py-2 rounded-lg bg-sky-500 text-white">พิมพ์ทะเบียน</button>
              <button className="w-full py-2 rounded-lg bg-emerald-500 text-white">ตรวจสอบเอกสาร</button>
            </div>
          </div>

          <div className="bg-white rounded-3xl p-4 shadow-xl hover:shadow-2xl transition-shadow duration-300">
            <h3 className="font-semibold">อัพโหลดเอกสาร</h3>
            <p className="text-sm text-gray-500 mt-1">ลากแล้ววางไฟล์ หรือคลิกเพื่อเลือก</p>
            <label className="mt-3 block border-dashed border-2 border-gray-200 rounded-lg p-4 text-center cursor-pointer">
              <input type="file" className="hidden" />
              <div className="text-sm text-gray-500">คลิกเพื่อเลือกไฟล์ PDF หรือรูปภาพ</div>
            </label>
          </div>

          <div className="bg-white rounded-3xl p-4 shadow-xl hover:shadow-2xl transition-shadow duration-300">
            <h3 className="font-semibold">ติดต่อ</h3>
            <div className="mt-2 text-sm text-gray-600">
              <div>โทร: 02-xxx-xxxx</div>
              <div>อีเมล: registrar@univ.ac.th</div>
            </div>
          </div>
        </aside>
      </main>

      <footer className="max-w-7xl mx-auto mt-10 text-center text-sm text-gray-400">
        © {new Date().getFullYear()} ห้องงานทะเบียนวัดผล — มหาวิทยาลัยตัวอย่าง
      </footer>
    </div>
  );
}
